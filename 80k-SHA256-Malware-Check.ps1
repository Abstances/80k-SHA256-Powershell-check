# Import the malware hash database
$database = Import-Csv -Path "‪C:\malware-hashes.csv"

# Set the root directory to start the search from
$root = "C:\"

# Get all files in the root directory and its subdirectories
$files = Get-ChildItem -Path $root -Recurse -File

# Loop through each file and check if it is malware
foreach ($file in $files) {
  # Calculate the hash of the file
  $hash = Get-FileHash -Path $file.FullName -Algorithm MD5

  # Check if the hash is in the database
  $malware = $database | Where-Object {$_.Hash -eq $hash.Hash}

  # If the hash is in the database, the file is likely malware
  if ($malware) {
    Write-Output "Malware detected: $($file.FullName)"
  }
}
